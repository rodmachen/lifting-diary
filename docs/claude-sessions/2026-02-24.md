# Claude Session — 2026-02-24

## Project: lifting-diary

### Topic: Getting started on a new machine

**User question:** What do I need to do to start development work on this repo for the first time?

**Resolution:** Outlined the full setup steps:
1. `npm install` to install dependencies
2. Create `.env.local` with Clerk keys (`NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY`, `CLERK_SECRET_KEY`) and Neon Postgres (`DATABASE_URL`)
3. `npx drizzle-kit push` to sync the database schema
4. `npm run dev` to start the dev server at localhost:3000

---

### Topic: Fix ESLint errors

**User question:** Run `npm run lint` and fix errors.

**Resolution:** Found 2 errors and 1 warning:
- `src/components/dark-mode-toggle.tsx` — Two `setState` calls inside `useEffect` bodies triggered `react-hooks/set-state-in-effect` errors. Fixed by refactoring to `useSyncExternalStore` with a `MutationObserver` watching the `<html>` class attribute, eliminating the need for `useState` entirely.
- `src/data/workouts.ts` — Removed unused `exercises` import (warning treated as part of cleanup).

Lint now passes cleanly.

---

### Topic: Create routing documentation

**User question:** Create a new documentation file at `docs/routing.md` highlighting coding standards for routing.

**Resolution:** Created `docs/routing.md` covering:
- All app routes live under `/dashboard`
- Route protection requires two layers: Clerk middleware (`src/proxy.ts`) and server-side `auth()` guard with redirect in each page
- Conventions: new routes nested under `src/app/dashboard/`, dynamic segments use `[param]` folders, no authenticated functionality on root `/`

`CLAUDE.md` was also updated via the `docs-reference-updater` agent to include a reference to the new file.
